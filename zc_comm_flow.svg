<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 13.0.1 (20250615.1724)
 -->
<!-- Title: BLHeli_S_ZC_Comm_Flow Pages: 1 -->
<svg width="694pt" height="967pt"
 viewBox="0.00 0.00 694.00 967.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 963.25)">
<title>BLHeli_S_ZC_Comm_Flow</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-963.25 690,-963.25 690,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_zc_detection</title>
<polygon fill="lightgrey" stroke="lightgrey" points="134,-201.25 134,-605 458,-605 458,-201.25 134,-201.25"/>
<text xml:space="preserve" text-anchor="middle" x="296" y="-587.7" font-family="Times,serif" font-size="14.00">零交叉检测子流程</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_commutation</title>
<polygon fill="lightgrey" stroke="lightgrey" points="8,-8 8,-182.25 678,-182.25 678,-8 8,-8"/>
<text xml:space="preserve" text-anchor="middle" x="343" y="-164.95" font-family="Times,serif" font-size="14.00">换向子流程</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_timing</title>
<polygon fill="lightgrey" stroke="lightgrey" points="226,-638 226,-951.25 388,-951.25 388,-638 226,-638"/>
<text xml:space="preserve" text-anchor="middle" x="307" y="-933.95" font-family="Times,serif" font-size="14.00">时序计算子流程</text>
</g>
<!-- wait_for_comp_out_high -->
<g id="node1" class="node">
<title>wait_for_comp_out_high</title>
<polygon fill="lightgreen" stroke="black" points="289.62,-568.75 142.38,-568.75 142.38,-529.25 289.62,-529.25 289.62,-568.75"/>
<text xml:space="preserve" text-anchor="middle" x="216" y="-553.35" font-family="Arial" font-size="12.00">等待比较器输出高</text>
<text xml:space="preserve" text-anchor="middle" x="216" y="-536.1" font-family="Arial" font-size="12.00">wait_for_comp_out_high</text>
</g>
<!-- comp_check_timeout -->
<g id="node3" class="node">
<title>comp_check_timeout</title>
<polygon fill="lightblue" stroke="black" points="343.62,-492.25 214.38,-492.25 214.38,-452.75 343.62,-452.75 343.62,-492.25"/>
<text xml:space="preserve" text-anchor="middle" x="279" y="-476.85" font-family="Arial" font-size="12.00">检查超时</text>
<text xml:space="preserve" text-anchor="middle" x="279" y="-459.6" font-family="Arial" font-size="12.00">comp_check_timeout</text>
</g>
<!-- wait_for_comp_out_high&#45;&gt;comp_check_timeout -->
<g id="edge1" class="edge">
<title>wait_for_comp_out_high&#45;&gt;comp_check_timeout</title>
<path fill="none" stroke="black" d="M232.22,-528.81C239.28,-520.47 247.68,-510.53 255.41,-501.4"/>
<polygon fill="black" stroke="black" points="258.07,-503.67 261.85,-493.78 252.72,-499.15 258.07,-503.67"/>
</g>
<!-- wait_for_comp_out_low -->
<g id="node2" class="node">
<title>wait_for_comp_out_low</title>
<polygon fill="lightgreen" stroke="black" points="450.38,-568.75 307.62,-568.75 307.62,-529.25 450.38,-529.25 450.38,-568.75"/>
<text xml:space="preserve" text-anchor="middle" x="379" y="-553.35" font-family="Arial" font-size="12.00">等待比较器输出低</text>
<text xml:space="preserve" text-anchor="middle" x="379" y="-536.1" font-family="Arial" font-size="12.00">wait_for_comp_out_low</text>
</g>
<!-- wait_for_comp_out_low&#45;&gt;comp_check_timeout -->
<g id="edge2" class="edge">
<title>wait_for_comp_out_low&#45;&gt;comp_check_timeout</title>
<path fill="none" stroke="black" d="M353.25,-528.81C341.23,-519.86 326.75,-509.08 313.79,-499.41"/>
<polygon fill="black" stroke="black" points="315.99,-496.69 305.88,-493.52 311.81,-502.31 315.99,-496.69"/>
</g>
<!-- comp_read_wrong -->
<g id="node4" class="node">
<title>comp_read_wrong</title>
<polygon fill="lightblue" stroke="black" points="274.88,-401.75 159.12,-401.75 159.12,-362.25 274.88,-362.25 274.88,-401.75"/>
<text xml:space="preserve" text-anchor="middle" x="217" y="-386.35" font-family="Arial" font-size="12.00">比较器读取错误</text>
<text xml:space="preserve" text-anchor="middle" x="217" y="-369.1" font-family="Arial" font-size="12.00">comp_read_wrong</text>
</g>
<!-- comp_check_timeout&#45;&gt;comp_read_wrong -->
<g id="edge3" class="edge">
<title>comp_check_timeout&#45;&gt;comp_read_wrong</title>
<path fill="none" stroke="black" d="M234.52,-452.27C227.93,-447.5 222.02,-441.71 218,-434.75 214.28,-428.32 212.86,-420.64 212.64,-413.19"/>
<polygon fill="black" stroke="black" points="216.13,-413.55 213.06,-403.41 209.14,-413.25 216.13,-413.55"/>
<text xml:space="preserve" text-anchor="middle" x="237.5" y="-425.25" font-family="Arial" font-size="10.00">读取错误</text>
</g>
<!-- comp_read_ok -->
<g id="node5" class="node">
<title>comp_read_ok</title>
<polygon fill="lightblue" stroke="black" points="393,-401.75 293,-401.75 293,-362.25 393,-362.25 393,-401.75"/>
<text xml:space="preserve" text-anchor="middle" x="343" y="-386.35" font-family="Arial" font-size="12.00">比较器读取正确</text>
<text xml:space="preserve" text-anchor="middle" x="343" y="-369.1" font-family="Arial" font-size="12.00">comp_read_ok</text>
</g>
<!-- comp_check_timeout&#45;&gt;comp_read_ok -->
<g id="edge4" class="edge">
<title>comp_check_timeout&#45;&gt;comp_read_ok</title>
<path fill="none" stroke="black" d="M295.26,-452.34C299.83,-446.76 304.71,-440.59 309,-434.75 314.39,-427.4 319.95,-419.24 324.96,-411.61"/>
<polygon fill="black" stroke="black" points="327.86,-413.57 330.36,-403.27 321.99,-409.76 327.86,-413.57"/>
<text xml:space="preserve" text-anchor="middle" x="338.29" y="-425.25" font-family="Arial" font-size="10.00">读取正确</text>
</g>
<!-- comp_read_wrong&#45;&gt;comp_check_timeout -->
<g id="edge5" class="edge">
<title>comp_read_wrong&#45;&gt;comp_check_timeout</title>
<path fill="none" stroke="black" d="M241.14,-402.1C246.83,-407.39 252.54,-413.43 257,-419.75 261.69,-426.39 265.66,-434.19 268.88,-441.69"/>
<polygon fill="black" stroke="black" points="265.58,-442.87 272.5,-450.89 272.09,-440.3 265.58,-442.87"/>
<text xml:space="preserve" text-anchor="middle" x="285.01" y="-425.25" font-family="Arial" font-size="10.00">继续检测</text>
</g>
<!-- setup_comm_wait -->
<g id="node6" class="node">
<title>setup_comm_wait</title>
<polygon fill="lightblue" stroke="black" points="399.38,-325.25 286.62,-325.25 286.62,-285.75 399.38,-285.75 399.38,-325.25"/>
<text xml:space="preserve" text-anchor="middle" x="343" y="-309.85" font-family="Arial" font-size="12.00">设置换向等待</text>
<text xml:space="preserve" text-anchor="middle" x="343" y="-292.6" font-family="Arial" font-size="12.00">setup_comm_wait</text>
</g>
<!-- comp_read_ok&#45;&gt;setup_comm_wait -->
<g id="edge6" class="edge">
<title>comp_read_ok&#45;&gt;setup_comm_wait</title>
<path fill="none" stroke="black" d="M343,-361.81C343,-354.25 343,-345.38 343,-336.99"/>
<polygon fill="black" stroke="black" points="346.5,-337.13 343,-327.13 339.5,-337.13 346.5,-337.13"/>
</g>
<!-- evaluate_comparator_integrity -->
<g id="node7" class="node">
<title>evaluate_comparator_integrity</title>
<polygon fill="lightblue" stroke="black" points="431.62,-248.75 254.38,-248.75 254.38,-209.25 431.62,-209.25 431.62,-248.75"/>
<text xml:space="preserve" text-anchor="middle" x="343" y="-233.35" font-family="Arial" font-size="12.00">评估比较器完整性</text>
<text xml:space="preserve" text-anchor="middle" x="343" y="-216.1" font-family="Arial" font-size="12.00">evaluate_comparator_integrity</text>
</g>
<!-- setup_comm_wait&#45;&gt;evaluate_comparator_integrity -->
<g id="edge7" class="edge">
<title>setup_comm_wait&#45;&gt;evaluate_comparator_integrity</title>
<path fill="none" stroke="black" d="M343,-285.31C343,-277.75 343,-268.88 343,-260.49"/>
<polygon fill="black" stroke="black" points="346.5,-260.63 343,-250.63 339.5,-260.63 346.5,-260.63"/>
</g>
<!-- wait_for_comm -->
<g id="node8" class="node">
<title>wait_for_comm</title>
<polygon fill="lightyellow" stroke="black" points="391.5,-146 294.5,-146 294.5,-106.5 391.5,-106.5 391.5,-146"/>
<text xml:space="preserve" text-anchor="middle" x="343" y="-130.6" font-family="Arial" font-size="12.00">等待换向</text>
<text xml:space="preserve" text-anchor="middle" x="343" y="-113.35" font-family="Arial" font-size="12.00">wait_for_comm</text>
</g>
<!-- evaluate_comparator_integrity&#45;&gt;wait_for_comm -->
<g id="edge8" class="edge">
<title>evaluate_comparator_integrity&#45;&gt;wait_for_comm</title>
<path fill="none" stroke="black" d="M343,-209.05C343,-194.65 343,-174.54 343,-157.86"/>
<polygon fill="black" stroke="black" points="346.5,-157.97 343,-147.97 339.5,-157.97 346.5,-157.97"/>
</g>
<!-- comm1comm2 -->
<g id="node9" class="node">
<title>comm1comm2</title>
<polygon fill="lightblue" stroke="black" points="110,-55.5 16,-55.5 16,-16 110,-16 110,-55.5"/>
<text xml:space="preserve" text-anchor="middle" x="63" y="-40.1" font-family="Arial" font-size="12.00">换向1&#45;&gt;2</text>
<text xml:space="preserve" text-anchor="middle" x="63" y="-22.85" font-family="Arial" font-size="12.00">comm1comm2</text>
</g>
<!-- wait_for_comm&#45;&gt;comm1comm2 -->
<g id="edge9" class="edge">
<title>wait_for_comm&#45;&gt;comm1comm2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M294.2,-111.6C270.65,-104.87 242.03,-96.51 216.5,-88.5 184.73,-78.54 149.52,-66.72 120.85,-56.9"/>
<polygon fill="blue" stroke="blue" points="122.22,-53.67 111.63,-53.73 119.95,-60.29 122.22,-53.67"/>
<text xml:space="preserve" text-anchor="middle" x="230.75" y="-79" font-family="Arial" font-size="10.00">在run1</text>
</g>
<!-- comm2comm3 -->
<g id="node10" class="node">
<title>comm2comm3</title>
<polygon fill="lightblue" stroke="black" points="222,-55.5 128,-55.5 128,-16 222,-16 222,-55.5"/>
<text xml:space="preserve" text-anchor="middle" x="175" y="-40.1" font-family="Arial" font-size="12.00">换向2&#45;&gt;3</text>
<text xml:space="preserve" text-anchor="middle" x="175" y="-22.85" font-family="Arial" font-size="12.00">comm2comm3</text>
</g>
<!-- wait_for_comm&#45;&gt;comm2comm3 -->
<g id="edge10" class="edge">
<title>wait_for_comm&#45;&gt;comm2comm3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M306.55,-106.05C281.56,-92.88 248.2,-75.31 221.33,-61.16"/>
<polygon fill="blue" stroke="blue" points="223.2,-58.19 212.72,-56.62 219.94,-64.38 223.2,-58.19"/>
<text xml:space="preserve" text-anchor="middle" x="283.31" y="-79" font-family="Arial" font-size="10.00">在run2</text>
</g>
<!-- comm3comm4 -->
<g id="node11" class="node">
<title>comm3comm4</title>
<polygon fill="lightblue" stroke="black" points="334,-55.5 240,-55.5 240,-16 334,-16 334,-55.5"/>
<text xml:space="preserve" text-anchor="middle" x="287" y="-40.1" font-family="Arial" font-size="12.00">换向3&#45;&gt;4</text>
<text xml:space="preserve" text-anchor="middle" x="287" y="-22.85" font-family="Arial" font-size="12.00">comm3comm4</text>
</g>
<!-- wait_for_comm&#45;&gt;comm3comm4 -->
<g id="edge11" class="edge">
<title>wait_for_comm&#45;&gt;comm3comm4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M330.85,-106.05C323.36,-94.22 313.63,-78.83 305.23,-65.56"/>
<polygon fill="blue" stroke="blue" points="308.24,-63.77 299.94,-57.19 302.33,-67.52 308.24,-63.77"/>
<text xml:space="preserve" text-anchor="middle" x="332.6" y="-79" font-family="Arial" font-size="10.00">在run3</text>
</g>
<!-- comm4comm5 -->
<g id="node12" class="node">
<title>comm4comm5</title>
<polygon fill="lightblue" stroke="black" points="446,-55.5 352,-55.5 352,-16 446,-16 446,-55.5"/>
<text xml:space="preserve" text-anchor="middle" x="399" y="-40.1" font-family="Arial" font-size="12.00">换向4&#45;&gt;5</text>
<text xml:space="preserve" text-anchor="middle" x="399" y="-22.85" font-family="Arial" font-size="12.00">comm4comm5</text>
</g>
<!-- wait_for_comm&#45;&gt;comm4comm5 -->
<g id="edge12" class="edge">
<title>wait_for_comm&#45;&gt;comm4comm5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M355.15,-106.05C362.64,-94.22 372.37,-78.83 380.77,-65.56"/>
<polygon fill="blue" stroke="blue" points="383.67,-67.52 386.06,-57.19 377.76,-63.77 383.67,-67.52"/>
<text xml:space="preserve" text-anchor="middle" x="388.6" y="-79" font-family="Arial" font-size="10.00">在run4</text>
</g>
<!-- comm5comm6 -->
<g id="node13" class="node">
<title>comm5comm6</title>
<polygon fill="lightblue" stroke="black" points="558,-55.5 464,-55.5 464,-16 558,-16 558,-55.5"/>
<text xml:space="preserve" text-anchor="middle" x="511" y="-40.1" font-family="Arial" font-size="12.00">换向5&#45;&gt;6</text>
<text xml:space="preserve" text-anchor="middle" x="511" y="-22.85" font-family="Arial" font-size="12.00">comm5comm6</text>
</g>
<!-- wait_for_comm&#45;&gt;comm5comm6 -->
<g id="edge13" class="edge">
<title>wait_for_comm&#45;&gt;comm5comm6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M379.45,-106.05C404.44,-92.88 437.8,-75.31 464.67,-61.16"/>
<polygon fill="blue" stroke="blue" points="466.06,-64.38 473.28,-56.62 462.8,-58.19 466.06,-64.38"/>
<text xml:space="preserve" text-anchor="middle" x="451.31" y="-79" font-family="Arial" font-size="10.00">在run5</text>
</g>
<!-- comm6comm1 -->
<g id="node14" class="node">
<title>comm6comm1</title>
<polygon fill="lightblue" stroke="black" points="670,-55.5 576,-55.5 576,-16 670,-16 670,-55.5"/>
<text xml:space="preserve" text-anchor="middle" x="623" y="-40.1" font-family="Arial" font-size="12.00">换向6&#45;&gt;1</text>
<text xml:space="preserve" text-anchor="middle" x="623" y="-22.85" font-family="Arial" font-size="12.00">comm6comm1</text>
</g>
<!-- wait_for_comm&#45;&gt;comm6comm1 -->
<g id="edge14" class="edge">
<title>wait_for_comm&#45;&gt;comm6comm1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M391.7,-111.71C415.4,-104.98 444.27,-96.57 470,-88.5 501.55,-78.6 536.51,-66.84 565.03,-57.04"/>
<polygon fill="blue" stroke="blue" points="565.88,-60.44 574.19,-53.87 563.6,-53.83 565.88,-60.44"/>
<text xml:space="preserve" text-anchor="middle" x="526.46" y="-79" font-family="Arial" font-size="10.00">在run6</text>
</g>
<!-- calc_next_comm_timing -->
<g id="node15" class="node">
<title>calc_next_comm_timing</title>
<polygon fill="lightpink" stroke="black" points="379.5,-915 234.5,-915 234.5,-875.5 379.5,-875.5 379.5,-915"/>
<text xml:space="preserve" text-anchor="middle" x="307" y="-899.6" font-family="Arial" font-size="12.00">计算下一次换向时序</text>
<text xml:space="preserve" text-anchor="middle" x="307" y="-882.35" font-family="Arial" font-size="12.00">calc_next_comm_timing</text>
</g>
<!-- wait_advance_timing -->
<g id="node16" class="node">
<title>wait_advance_timing</title>
<polygon fill="lightblue" stroke="black" points="371.62,-838.5 242.38,-838.5 242.38,-799 371.62,-799 371.62,-838.5"/>
<text xml:space="preserve" text-anchor="middle" x="307" y="-823.1" font-family="Arial" font-size="12.00">等待提前时序</text>
<text xml:space="preserve" text-anchor="middle" x="307" y="-805.85" font-family="Arial" font-size="12.00">wait_advance_timing</text>
</g>
<!-- calc_next_comm_timing&#45;&gt;wait_advance_timing -->
<g id="edge15" class="edge">
<title>calc_next_comm_timing&#45;&gt;wait_advance_timing</title>
<path fill="none" stroke="black" d="M307,-875.06C307,-867.5 307,-858.63 307,-850.24"/>
<polygon fill="black" stroke="black" points="310.5,-850.38 307,-840.38 303.5,-850.38 310.5,-850.38"/>
</g>
<!-- calc_new_wait_times -->
<g id="node17" class="node">
<title>calc_new_wait_times</title>
<polygon fill="lightblue" stroke="black" points="372.38,-762 241.62,-762 241.62,-722.5 372.38,-722.5 372.38,-762"/>
<text xml:space="preserve" text-anchor="middle" x="307" y="-746.6" font-family="Arial" font-size="12.00">计算新等待时间</text>
<text xml:space="preserve" text-anchor="middle" x="307" y="-729.35" font-family="Arial" font-size="12.00">calc_new_wait_times</text>
</g>
<!-- wait_advance_timing&#45;&gt;calc_new_wait_times -->
<g id="edge16" class="edge">
<title>wait_advance_timing&#45;&gt;calc_new_wait_times</title>
<path fill="none" stroke="black" d="M307,-798.56C307,-791 307,-782.13 307,-773.74"/>
<polygon fill="black" stroke="black" points="310.5,-773.88 307,-763.88 303.5,-773.88 310.5,-773.88"/>
</g>
<!-- wait_before_zc_scan -->
<g id="node18" class="node">
<title>wait_before_zc_scan</title>
<polygon fill="lightblue" stroke="black" points="371.62,-685.5 242.38,-685.5 242.38,-646 371.62,-646 371.62,-685.5"/>
<text xml:space="preserve" text-anchor="middle" x="307" y="-670.1" font-family="Arial" font-size="12.00">等待零交叉扫描</text>
<text xml:space="preserve" text-anchor="middle" x="307" y="-652.85" font-family="Arial" font-size="12.00">wait_before_zc_scan</text>
</g>
<!-- calc_new_wait_times&#45;&gt;wait_before_zc_scan -->
<g id="edge17" class="edge">
<title>calc_new_wait_times&#45;&gt;wait_before_zc_scan</title>
<path fill="none" stroke="black" d="M307,-722.06C307,-714.5 307,-705.63 307,-697.24"/>
<polygon fill="black" stroke="black" points="310.5,-697.38 307,-687.38 303.5,-697.38 310.5,-697.38"/>
</g>
<!-- wait_before_zc_scan&#45;&gt;wait_for_comp_out_high -->
<g id="edge18" class="edge">
<title>wait_before_zc_scan&#45;&gt;wait_for_comp_out_high</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M276.81,-645.5C270.04,-640.33 263.25,-634.39 257.75,-628 245.3,-613.53 235.09,-594.72 227.89,-579.2"/>
<polygon fill="red" stroke="red" points="231.26,-578.17 224.01,-570.45 224.87,-581.01 231.26,-578.17"/>
<text xml:space="preserve" text-anchor="middle" x="291.88" y="-618.5" font-family="Arial" font-size="10.00">下一个检测周期</text>
</g>
<!-- wait_before_zc_scan&#45;&gt;wait_for_comp_out_low -->
<g id="edge19" class="edge">
<title>wait_before_zc_scan&#45;&gt;wait_for_comp_out_low</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M319.05,-645.54C330.54,-627.23 347.99,-599.42 361.1,-578.52"/>
<polygon fill="red" stroke="red" points="363.99,-580.5 366.34,-570.17 358.06,-576.78 363.99,-580.5"/>
<text xml:space="preserve" text-anchor="middle" x="372.81" y="-618.5" font-family="Arial" font-size="10.00">下一个检测周期</text>
</g>
</g>
</svg>
