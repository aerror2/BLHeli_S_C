<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 13.0.1 (20250615.1724)
 -->
<!-- Title: timing_flow Pages: 1 -->
<svg width="404pt" height="2128pt"
 viewBox="0.00 0.00 404.00 2128.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2123.75)">
<title>timing_flow</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-2123.75 399.92,-2123.75 399.92,4 -4,4"/>
<!-- title -->
<g id="node1" class="node">
<title>title</title>
<path fill="none" stroke="none" d="M237.68,-1793.15C237.68,-1793.15 16.88,-1793.15 16.88,-1793.15 10.88,-1793.15 4.88,-1787.15 4.88,-1781.15 4.88,-1781.15 4.88,-1753.1 4.88,-1753.1 4.88,-1747.1 10.88,-1741.1 16.88,-1741.1 16.88,-1741.1 237.68,-1741.1 237.68,-1741.1 243.68,-1741.1 249.68,-1747.1 249.68,-1753.1 249.68,-1753.1 249.68,-1781.15 249.68,-1781.15 249.68,-1787.15 243.68,-1793.15 237.68,-1793.15"/>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1763.55" font-family="Arial Bold" font-size="16.00">BLHeli_S 换相时序计算流程图</text>
</g>
<!-- calc_next_comm_timing -->
<g id="node2" class="node">
<title>calc_next_comm_timing</title>
<path fill="gold" stroke="black" d="M203.18,-1704.1C203.18,-1704.1 51.38,-1704.1 51.38,-1704.1 45.38,-1704.1 39.38,-1698.1 39.38,-1692.1 39.38,-1692.1 39.38,-1651.3 39.38,-1651.3 39.38,-1645.3 45.38,-1639.3 51.38,-1639.3 51.38,-1639.3 203.18,-1639.3 203.18,-1639.3 209.18,-1639.3 215.18,-1645.3 215.18,-1651.3 215.18,-1651.3 215.18,-1692.1 215.18,-1692.1 215.18,-1698.1 209.18,-1704.1 203.18,-1704.1"/>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1676.4" font-family="Arial" font-size="14.00">calc_next_comm_timing</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1660.65" font-family="Arial" font-size="14.00">换相时序计算</text>
</g>
<!-- title&#45;&gt;calc_next_comm_timing -->
<g id="edge1" class="edge">
<title>title&#45;&gt;calc_next_comm_timing</title>
<path fill="none" stroke="black" d="M127.28,-1741.58C127.28,-1733.68 127.28,-1724.69 127.28,-1715.87"/>
<polygon fill="black" stroke="black" points="130.78,-1715.99 127.28,-1705.99 123.78,-1715.99 130.78,-1715.99"/>
</g>
<!-- store_comm_time -->
<g id="node3" class="node">
<title>store_comm_time</title>
<path fill="lightblue" stroke="black" d="M204.68,-1602.3C204.68,-1602.3 49.88,-1602.3 49.88,-1602.3 43.88,-1602.3 37.88,-1596.3 37.88,-1590.3 37.88,-1590.3 37.88,-1545 37.88,-1545 37.88,-1539 43.88,-1533 49.88,-1533 49.88,-1533 204.68,-1533 204.68,-1533 210.68,-1533 216.68,-1539 216.68,-1545 216.68,-1545 216.68,-1590.3 216.68,-1590.3 216.68,-1596.3 210.68,-1602.3 204.68,-1602.3"/>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1574.6" font-family="Arial" font-size="14.00">存储当前换相时间</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1554.35" font-family="Arial" font-size="14.00">到Comm_Period4&#45;1数组</text>
</g>
<!-- calc_next_comm_timing&#45;&gt;store_comm_time -->
<g id="edge2" class="edge">
<title>calc_next_comm_timing&#45;&gt;store_comm_time</title>
<path fill="none" stroke="black" d="M127.28,-1638.97C127.28,-1631.01 127.28,-1622.31 127.28,-1613.82"/>
<polygon fill="black" stroke="black" points="130.78,-1614 127.28,-1604 123.78,-1614 130.78,-1614"/>
</g>
<!-- calc_avg_comm_time -->
<g id="node4" class="node">
<title>calc_avg_comm_time</title>
<path fill="lightblue" stroke="black" d="M183.3,-1496C183.3,-1496 71.25,-1496 71.25,-1496 65.25,-1496 59.25,-1490 59.25,-1484 59.25,-1484 59.25,-1438.7 59.25,-1438.7 59.25,-1432.7 65.25,-1426.7 71.25,-1426.7 71.25,-1426.7 183.3,-1426.7 183.3,-1426.7 189.3,-1426.7 195.3,-1432.7 195.3,-1438.7 195.3,-1438.7 195.3,-1484 195.3,-1484 195.3,-1490 189.3,-1496 183.3,-1496"/>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1468.3" font-family="Arial" font-size="14.00">计算前4次换相的</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1448.05" font-family="Arial" font-size="14.00">平均时间</text>
</g>
<!-- store_comm_time&#45;&gt;calc_avg_comm_time -->
<g id="edge3" class="edge">
<title>store_comm_time&#45;&gt;calc_avg_comm_time</title>
<path fill="none" stroke="black" d="M127.28,-1532.79C127.28,-1524.77 127.28,-1516.1 127.28,-1507.66"/>
<polygon fill="black" stroke="black" points="130.78,-1507.91 127.28,-1497.91 123.78,-1507.91 130.78,-1507.91"/>
</g>
<!-- calc_degrees_15 -->
<g id="node5" class="node">
<title>calc_degrees_15</title>
<path fill="lightblue" stroke="black" d="M194.18,-1389.7C194.18,-1389.7 60.38,-1389.7 60.38,-1389.7 54.38,-1389.7 48.38,-1383.7 48.38,-1377.7 48.38,-1377.7 48.38,-1332.4 48.38,-1332.4 48.38,-1326.4 54.38,-1320.4 60.38,-1320.4 60.38,-1320.4 194.18,-1320.4 194.18,-1320.4 200.18,-1320.4 206.18,-1326.4 206.18,-1332.4 206.18,-1332.4 206.18,-1377.7 206.18,-1377.7 206.18,-1383.7 200.18,-1389.7 194.18,-1389.7"/>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1362" font-family="Arial" font-size="14.00">计算15度电角度时间</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1341.75" font-family="Arial" font-size="14.00">(平均时间 / 6)</text>
</g>
<!-- calc_avg_comm_time&#45;&gt;calc_degrees_15 -->
<g id="edge4" class="edge">
<title>calc_avg_comm_time&#45;&gt;calc_degrees_15</title>
<path fill="none" stroke="black" d="M127.28,-1426.49C127.28,-1418.47 127.28,-1409.8 127.28,-1401.36"/>
<polygon fill="black" stroke="black" points="130.78,-1401.61 127.28,-1391.61 123.78,-1401.61 130.78,-1401.61"/>
</g>
<!-- calc_degrees_7_5 -->
<g id="node6" class="node">
<title>calc_degrees_7_5</title>
<path fill="lightblue" stroke="black" d="M196.05,-1283.4C196.05,-1283.4 58.5,-1283.4 58.5,-1283.4 52.5,-1283.4 46.5,-1277.4 46.5,-1271.4 46.5,-1271.4 46.5,-1226.1 46.5,-1226.1 46.5,-1220.1 52.5,-1214.1 58.5,-1214.1 58.5,-1214.1 196.05,-1214.1 196.05,-1214.1 202.05,-1214.1 208.05,-1220.1 208.05,-1226.1 208.05,-1226.1 208.05,-1271.4 208.05,-1271.4 208.05,-1277.4 202.05,-1283.4 196.05,-1283.4"/>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1255.7" font-family="Arial" font-size="14.00">计算7.5度电角度时间</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1235.45" font-family="Arial" font-size="14.00">(15度时间 / 2)</text>
</g>
<!-- calc_degrees_15&#45;&gt;calc_degrees_7_5 -->
<g id="edge5" class="edge">
<title>calc_degrees_15&#45;&gt;calc_degrees_7_5</title>
<path fill="none" stroke="black" d="M127.28,-1320.19C127.28,-1312.17 127.28,-1303.5 127.28,-1295.06"/>
<polygon fill="black" stroke="black" points="130.78,-1295.31 127.28,-1285.31 123.78,-1295.31 130.78,-1295.31"/>
</g>
<!-- check_rpm_too_low -->
<g id="node11" class="node">
<title>check_rpm_too_low</title>
<path fill="lightsalmon" stroke="black" d="M213.3,-1177.1C213.3,-1177.1 41.25,-1177.1 41.25,-1177.1 35.25,-1177.1 29.25,-1171.1 29.25,-1165.1 29.25,-1165.1 29.25,-1124.3 29.25,-1124.3 29.25,-1118.3 35.25,-1112.3 41.25,-1112.3 41.25,-1112.3 213.3,-1112.3 213.3,-1112.3 219.3,-1112.3 225.3,-1118.3 225.3,-1124.3 225.3,-1124.3 225.3,-1165.1 225.3,-1165.1 225.3,-1171.1 219.3,-1177.1 213.3,-1177.1"/>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1149.4" font-family="Arial" font-size="14.00">检查RPM是否过低</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1129.15" font-family="Arial" font-size="14.00">(Comm_Period4 &gt; 0xFFFF)</text>
</g>
<!-- calc_degrees_7_5&#45;&gt;check_rpm_too_low -->
<g id="edge6" class="edge">
<title>calc_degrees_7_5&#45;&gt;check_rpm_too_low</title>
<path fill="none" stroke="black" d="M127.28,-1213.77C127.28,-1205.81 127.28,-1197.22 127.28,-1188.92"/>
<polygon fill="black" stroke="black" points="130.78,-1188.98 127.28,-1178.98 123.78,-1188.98 130.78,-1188.98"/>
</g>
<!-- set_zc_scan_timeout -->
<g id="node7" class="node">
<title>set_zc_scan_timeout</title>
<path fill="lightblue" stroke="black" d="M189.8,-955C189.8,-955 56.75,-955 56.75,-955 50.75,-955 44.75,-949 44.75,-943 44.75,-943 44.75,-902.2 44.75,-902.2 44.75,-896.2 50.75,-890.2 56.75,-890.2 56.75,-890.2 189.8,-890.2 189.8,-890.2 195.8,-890.2 201.8,-896.2 201.8,-902.2 201.8,-902.2 201.8,-943 201.8,-943 201.8,-949 195.8,-955 189.8,-955"/>
<text xml:space="preserve" text-anchor="middle" x="123.28" y="-927.3" font-family="Arial" font-size="14.00">设置零交叉扫描超时</text>
<text xml:space="preserve" text-anchor="middle" x="123.28" y="-907.05" font-family="Arial" font-size="14.00">(Comm_Period4 * 4)</text>
</g>
<!-- set_zc_scan_delay -->
<g id="node8" class="node">
<title>set_zc_scan_delay</title>
<path fill="lightblue" stroke="black" d="M189.8,-853.2C189.8,-853.2 56.75,-853.2 56.75,-853.2 50.75,-853.2 44.75,-847.2 44.75,-841.2 44.75,-841.2 44.75,-795.9 44.75,-795.9 44.75,-789.9 50.75,-783.9 56.75,-783.9 56.75,-783.9 189.8,-783.9 189.8,-783.9 195.8,-783.9 201.8,-789.9 201.8,-795.9 201.8,-795.9 201.8,-841.2 201.8,-841.2 201.8,-847.2 195.8,-853.2 189.8,-853.2"/>
<text xml:space="preserve" text-anchor="middle" x="123.28" y="-825.5" font-family="Arial" font-size="14.00">设置零交叉扫描延时</text>
<text xml:space="preserve" text-anchor="middle" x="123.28" y="-805.25" font-family="Arial" font-size="14.00">(7.5度电角度)</text>
</g>
<!-- set_zc_scan_timeout&#45;&gt;set_zc_scan_delay -->
<g id="edge10" class="edge">
<title>set_zc_scan_timeout&#45;&gt;set_zc_scan_delay</title>
<path fill="none" stroke="black" d="M123.28,-889.87C123.28,-881.91 123.28,-873.21 123.28,-864.72"/>
<polygon fill="black" stroke="black" points="126.78,-864.9 123.28,-854.9 119.78,-864.9 126.78,-864.9"/>
</g>
<!-- set_comm_timeout -->
<g id="node9" class="node">
<title>set_comm_timeout</title>
<path fill="lightblue" stroke="black" d="M187.93,-746.9C187.93,-746.9 58.62,-746.9 58.62,-746.9 52.62,-746.9 46.62,-740.9 46.62,-734.9 46.62,-734.9 46.62,-694.1 46.62,-694.1 46.62,-688.1 52.62,-682.1 58.62,-682.1 58.62,-682.1 187.93,-682.1 187.93,-682.1 193.93,-682.1 199.93,-688.1 199.93,-694.1 199.93,-694.1 199.93,-734.9 199.93,-734.9 199.93,-740.9 193.93,-746.9 187.93,-746.9"/>
<text xml:space="preserve" text-anchor="middle" x="123.28" y="-719.2" font-family="Arial" font-size="14.00">设置换相超时</text>
<text xml:space="preserve" text-anchor="middle" x="123.28" y="-698.95" font-family="Arial" font-size="14.00">(Comm_Period4 * 2)</text>
</g>
<!-- set_zc_scan_delay&#45;&gt;set_comm_timeout -->
<g id="edge11" class="edge">
<title>set_zc_scan_delay&#45;&gt;set_comm_timeout</title>
<path fill="none" stroke="black" d="M123.28,-783.57C123.28,-775.61 123.28,-767.02 123.28,-758.72"/>
<polygon fill="black" stroke="black" points="126.78,-758.78 123.28,-748.78 119.78,-758.78 126.78,-758.78"/>
</g>
<!-- check_startup_phase -->
<g id="node13" class="node">
<title>check_startup_phase</title>
<path fill="lightgreen" stroke="black" d="M168.43,-645.1C168.43,-645.1 78.12,-645.1 78.12,-645.1 72.12,-645.1 66.12,-639.1 66.12,-633.1 66.12,-633.1 66.12,-587.8 66.12,-587.8 66.12,-581.8 72.12,-575.8 78.12,-575.8 78.12,-575.8 168.43,-575.8 168.43,-575.8 174.43,-575.8 180.43,-581.8 180.43,-587.8 180.43,-587.8 180.43,-633.1 180.43,-633.1 180.43,-639.1 174.43,-645.1 168.43,-645.1"/>
<text xml:space="preserve" text-anchor="middle" x="123.28" y="-617.4" font-family="Arial" font-size="14.00">检查是否处于</text>
<text xml:space="preserve" text-anchor="middle" x="123.28" y="-597.15" font-family="Arial" font-size="14.00">启动阶段</text>
</g>
<!-- set_comm_timeout&#45;&gt;check_startup_phase -->
<g id="edge12" class="edge">
<title>set_comm_timeout&#45;&gt;check_startup_phase</title>
<path fill="none" stroke="black" d="M123.28,-681.77C123.28,-673.81 123.28,-665.11 123.28,-656.62"/>
<polygon fill="black" stroke="black" points="126.78,-656.8 123.28,-646.8 119.78,-656.8 126.78,-656.8"/>
</g>
<!-- set_advance_timing -->
<g id="node10" class="node">
<title>set_advance_timing</title>
<path fill="lightblue" stroke="black" d="M378.55,-175.6C378.55,-175.6 238,-175.6 238,-175.6 232,-175.6 226,-169.6 226,-163.6 226,-163.6 226,-118.3 226,-118.3 226,-112.3 232,-106.3 238,-106.3 238,-106.3 378.55,-106.3 378.55,-106.3 384.55,-106.3 390.55,-112.3 390.55,-118.3 390.55,-118.3 390.55,-163.6 390.55,-163.6 390.55,-169.6 384.55,-175.6 378.55,-175.6"/>
<text xml:space="preserve" text-anchor="middle" x="308.27" y="-147.9" font-family="Arial" font-size="14.00">设置提前换相定时</text>
<text xml:space="preserve" text-anchor="middle" x="308.27" y="-127.65" font-family="Arial" font-size="14.00">(15度电角度 &#45; 提前角)</text>
</g>
<!-- set_timer3 -->
<g id="node18" class="node">
<title>set_timer3</title>
<path fill="lightpink" stroke="black" d="M255.68,-69.3C255.68,-69.3 136.88,-69.3 136.88,-69.3 130.88,-69.3 124.88,-63.3 124.88,-57.3 124.88,-57.3 124.88,-12 124.88,-12 124.88,-6 130.88,0 136.88,0 136.88,0 255.68,0 255.68,0 261.68,0 267.68,-6 267.68,-12 267.68,-12 267.68,-57.3 267.68,-57.3 267.68,-63.3 261.68,-69.3 255.68,-69.3"/>
<text xml:space="preserve" text-anchor="middle" x="196.28" y="-41.6" font-family="Arial" font-size="14.00">设置Timer3</text>
<text xml:space="preserve" text-anchor="middle" x="196.28" y="-21.35" font-family="Arial" font-size="14.00">用于提前换相定时</text>
</g>
<!-- set_advance_timing&#45;&gt;set_timer3 -->
<g id="edge20" class="edge">
<title>set_advance_timing&#45;&gt;set_timer3</title>
<path fill="none" stroke="black" d="M271.91,-106.09C262.13,-96.98 251.44,-87.02 241.25,-77.53"/>
<polygon fill="black" stroke="black" points="243.65,-74.99 233.95,-70.73 238.88,-80.11 243.65,-74.99"/>
</g>
<!-- check_rpm_too_low&#45;&gt;set_zc_scan_timeout -->
<g id="edge8" class="edge">
<title>check_rpm_too_low&#45;&gt;set_zc_scan_timeout</title>
<path fill="none" stroke="black" d="M124.07,-1112.04C122.68,-1096.73 121.21,-1078.08 120.53,-1061.3 119.27,-1030.53 119.91,-1022.79 120.53,-992 120.69,-983.75 120.97,-974.94 121.29,-966.49"/>
<polygon fill="black" stroke="black" points="124.77,-966.91 121.68,-956.77 117.78,-966.63 124.77,-966.91"/>
<text xml:space="preserve" text-anchor="middle" x="125.4" y="-1024.65" font-family="Arial" font-size="10.00">否</text>
</g>
<!-- handle_low_rpm -->
<g id="node12" class="node">
<title>handle_low_rpm</title>
<path fill="lightsalmon" stroke="black" d="M257.68,-1061.3C257.68,-1061.3 150.88,-1061.3 150.88,-1061.3 144.88,-1061.3 138.88,-1055.3 138.88,-1049.3 138.88,-1049.3 138.88,-1004 138.88,-1004 138.88,-998 144.88,-992 150.88,-992 150.88,-992 257.68,-992 257.68,-992 263.68,-992 269.68,-998 269.68,-1004 269.68,-1004 269.68,-1049.3 269.68,-1049.3 269.68,-1055.3 263.68,-1061.3 257.68,-1061.3"/>
<text xml:space="preserve" text-anchor="middle" x="204.28" y="-1033.6" font-family="Arial" font-size="14.00">处理低RPM情况</text>
<text xml:space="preserve" text-anchor="middle" x="204.28" y="-1013.35" font-family="Arial" font-size="14.00">设置最大周期</text>
</g>
<!-- check_rpm_too_low&#45;&gt;handle_low_rpm -->
<g id="edge7" class="edge">
<title>check_rpm_too_low&#45;&gt;handle_low_rpm</title>
<path fill="none" stroke="black" d="M148.32,-1111.99C156.63,-1099.46 166.32,-1084.86 175.28,-1071.35"/>
<polygon fill="black" stroke="black" points="178.19,-1073.29 180.8,-1063.02 172.36,-1069.42 178.19,-1073.29"/>
<text xml:space="preserve" text-anchor="middle" x="172.96" y="-1084.8" font-family="Arial" font-size="10.00">是</text>
</g>
<!-- handle_low_rpm&#45;&gt;set_zc_scan_timeout -->
<g id="edge9" class="edge">
<title>handle_low_rpm&#45;&gt;set_zc_scan_timeout</title>
<path fill="none" stroke="black" d="M177.3,-991.67C170.33,-982.88 162.75,-973.34 155.54,-964.25"/>
<polygon fill="black" stroke="black" points="158.39,-962.2 149.43,-956.55 152.9,-966.56 158.39,-962.2"/>
</g>
<!-- startup_timing_adjust -->
<g id="node14" class="node">
<title>startup_timing_adjust</title>
<path fill="lightgreen" stroke="black" d="M161.68,-437.5C161.68,-437.5 42.88,-437.5 42.88,-437.5 36.88,-437.5 30.88,-431.5 30.88,-425.5 30.88,-425.5 30.88,-380.2 30.88,-380.2 30.88,-374.2 36.88,-368.2 42.88,-368.2 42.88,-368.2 161.68,-368.2 161.68,-368.2 167.68,-368.2 173.68,-374.2 173.68,-380.2 173.68,-380.2 173.68,-425.5 173.68,-425.5 173.68,-431.5 167.68,-437.5 161.68,-437.5"/>
<text xml:space="preserve" text-anchor="middle" x="102.28" y="-409.8" font-family="Arial" font-size="14.00">启动阶段时序调整</text>
<text xml:space="preserve" text-anchor="middle" x="102.28" y="-389.55" font-family="Arial" font-size="14.00">使用固定延时</text>
</g>
<!-- check_startup_phase&#45;&gt;startup_timing_adjust -->
<g id="edge13" class="edge">
<title>check_startup_phase&#45;&gt;startup_timing_adjust</title>
<path fill="none" stroke="black" d="M119.81,-575.5C116.28,-540.98 110.8,-487.28 106.9,-449.15"/>
<polygon fill="black" stroke="black" points="110.4,-448.95 105.9,-439.36 103.44,-449.66 110.4,-448.95"/>
<text xml:space="preserve" text-anchor="middle" x="122.84" y="-548.3" font-family="Arial" font-size="10.00">是</text>
</g>
<!-- check_initial_run_phase -->
<g id="node15" class="node">
<title>check_initial_run_phase</title>
<path fill="lightgreen" stroke="black" d="M241.43,-524.8C241.43,-524.8 151.12,-524.8 151.12,-524.8 145.12,-524.8 139.12,-518.8 139.12,-512.8 139.12,-512.8 139.12,-467.5 139.12,-467.5 139.12,-461.5 145.12,-455.5 151.12,-455.5 151.12,-455.5 241.43,-455.5 241.43,-455.5 247.43,-455.5 253.43,-461.5 253.43,-467.5 253.43,-467.5 253.43,-512.8 253.43,-512.8 253.43,-518.8 247.43,-524.8 241.43,-524.8"/>
<text xml:space="preserve" text-anchor="middle" x="196.28" y="-497.1" font-family="Arial" font-size="14.00">检查是否处于</text>
<text xml:space="preserve" text-anchor="middle" x="196.28" y="-476.85" font-family="Arial" font-size="14.00">初始运行阶段</text>
</g>
<!-- check_startup_phase&#45;&gt;check_initial_run_phase -->
<g id="edge14" class="edge">
<title>check_startup_phase&#45;&gt;check_initial_run_phase</title>
<path fill="none" stroke="black" d="M144.19,-575.55C152.06,-562.8 161.11,-548.13 169.44,-534.63"/>
<polygon fill="black" stroke="black" points="172.29,-536.69 174.56,-526.34 166.33,-533.02 172.29,-536.69"/>
<text xml:space="preserve" text-anchor="middle" x="169.02" y="-548.3" font-family="Arial" font-size="10.00">否</text>
</g>
<!-- startup_timing_adjust&#45;&gt;set_timer3 -->
<g id="edge15" class="edge">
<title>startup_timing_adjust&#45;&gt;set_timer3</title>
<path fill="none" stroke="black" d="M104.11,-367.77C106.98,-326.07 114,-253.63 130.28,-193.6 141.07,-153.78 159.56,-110.71 174.23,-79.61"/>
<polygon fill="black" stroke="black" points="177.23,-81.45 178.39,-70.92 170.92,-78.43 177.23,-81.45"/>
</g>
<!-- initial_run_timing_adjust -->
<g id="node16" class="node">
<title>initial_run_timing_adjust</title>
<path fill="lightgreen" stroke="black" d="M241.43,-262.9C241.43,-262.9 151.12,-262.9 151.12,-262.9 145.12,-262.9 139.12,-256.9 139.12,-250.9 139.12,-250.9 139.12,-205.6 139.12,-205.6 139.12,-199.6 145.12,-193.6 151.12,-193.6 151.12,-193.6 241.43,-193.6 241.43,-193.6 247.43,-193.6 253.43,-199.6 253.43,-205.6 253.43,-205.6 253.43,-250.9 253.43,-250.9 253.43,-256.9 247.43,-262.9 241.43,-262.9"/>
<text xml:space="preserve" text-anchor="middle" x="196.28" y="-235.2" font-family="Arial" font-size="14.00">初始运行阶段</text>
<text xml:space="preserve" text-anchor="middle" x="196.28" y="-214.95" font-family="Arial" font-size="14.00">时序渐进调整</text>
</g>
<!-- check_initial_run_phase&#45;&gt;initial_run_timing_adjust -->
<g id="edge16" class="edge">
<title>check_initial_run_phase&#45;&gt;initial_run_timing_adjust</title>
<path fill="none" stroke="black" d="M196.28,-455.17C196.28,-408.96 196.28,-326.17 196.28,-274.67"/>
<polygon fill="black" stroke="black" points="199.78,-274.75 196.28,-264.75 192.78,-274.75 199.78,-274.75"/>
<text xml:space="preserve" text-anchor="middle" x="201.15" y="-400.85" font-family="Arial" font-size="10.00">是</text>
</g>
<!-- normal_run_timing -->
<g id="node17" class="node">
<title>normal_run_timing</title>
<path fill="lightcyan" stroke="black" d="M383.92,-350.2C383.92,-350.2 236.62,-350.2 236.62,-350.2 230.62,-350.2 224.62,-344.2 224.62,-338.2 224.62,-338.2 224.62,-292.9 224.62,-292.9 224.62,-286.9 230.62,-280.9 236.62,-280.9 236.62,-280.9 383.92,-280.9 383.92,-280.9 389.92,-280.9 395.92,-286.9 395.92,-292.9 395.92,-292.9 395.92,-338.2 395.92,-338.2 395.92,-344.2 389.92,-350.2 383.92,-350.2"/>
<text xml:space="preserve" text-anchor="middle" x="310.27" y="-322.5" font-family="Arial" font-size="14.00">正常运行阶段</text>
<text xml:space="preserve" text-anchor="middle" x="310.27" y="-302.25" font-family="Arial" font-size="14.00">根据设置的提前角计算</text>
</g>
<!-- check_initial_run_phase&#45;&gt;normal_run_timing -->
<g id="edge17" class="edge">
<title>check_initial_run_phase&#45;&gt;normal_run_timing</title>
<path fill="none" stroke="black" d="M218.8,-455.05C236.83,-427.75 262.24,-389.27 281.71,-359.81"/>
<polygon fill="black" stroke="black" points="284.37,-362.12 286.96,-351.84 278.53,-358.26 284.37,-362.12"/>
<text xml:space="preserve" text-anchor="middle" x="278.28" y="-400.85" font-family="Arial" font-size="10.00">否</text>
</g>
<!-- initial_run_timing_adjust&#45;&gt;set_timer3 -->
<g id="edge18" class="edge">
<title>initial_run_timing_adjust&#45;&gt;set_timer3</title>
<path fill="none" stroke="black" d="M196.28,-193.44C196.28,-162.16 196.28,-115.45 196.28,-80.96"/>
<polygon fill="black" stroke="black" points="199.78,-81.28 196.28,-71.28 192.78,-81.28 199.78,-81.28"/>
</g>
<!-- normal_run_timing&#45;&gt;set_advance_timing -->
<g id="edge19" class="edge">
<title>normal_run_timing&#45;&gt;set_advance_timing</title>
<path fill="none" stroke="black" d="M309.88,-280.45C309.57,-253.74 309.14,-216.34 308.8,-187.13"/>
<polygon fill="black" stroke="black" points="312.3,-187.45 308.69,-177.49 305.3,-187.53 312.3,-187.45"/>
</g>
<!-- explanation -->
<g id="node19" class="node">
<title>explanation</title>
<polygon fill="lightyellow" stroke="black" points="248.55,-1963.95 0,-1963.95 0,-1830.15 254.55,-1830.15 254.55,-1957.95 248.55,-1963.95"/>
<polyline fill="none" stroke="black" points="248.55,-1963.95 248.55,-1957.95"/>
<polyline fill="none" stroke="black" points="254.55,-1957.95 248.55,-1957.95"/>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1940.05" font-family="Arial" font-size="10.00">换相时序计算逻辑:</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1925.05" font-family="Arial" font-size="10.00">1. 每次换相后调用calc_next_comm_timing</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1910.05" font-family="Arial" font-size="10.00">2. 存储最近4次换相时间并计算平均值</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1895.05" font-family="Arial" font-size="10.00">3. 计算15度和7.5度电角度对应的时间</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1880.05" font-family="Arial" font-size="10.00">4. 换相后延时7.5度开始检测零交叉</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1865.05" font-family="Arial" font-size="10.00">5. 检测到零交叉后延时(15度&#45;提前角)进行下一次换相</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-1850.05" font-family="Arial" font-size="10.00">6. 根据运行阶段(启动/初始运行/正常)调整时序</text>
</g>
<!-- explanation&#45;&gt;title -->
<!-- zc_comm_relation -->
<g id="node20" class="node">
<title>zc_comm_relation</title>
<polygon fill="lightyellow" stroke="black" points="226.8,-2119.75 21.75,-2119.75 21.75,-2000.95 232.8,-2000.95 232.8,-2113.75 226.8,-2119.75"/>
<polyline fill="none" stroke="black" points="226.8,-2119.75 226.8,-2113.75"/>
<polyline fill="none" stroke="black" points="232.8,-2113.75 226.8,-2113.75"/>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-2095.85" font-family="Arial" font-size="10.00">零交叉检测与换相关系:</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-2080.85" font-family="Arial" font-size="10.00">&#45; 每个相位的反电动势在电角度30度处过零</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-2065.85" font-family="Arial" font-size="10.00">&#45; 理想换相点在零交叉后的电角度15度处</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-2050.85" font-family="Arial" font-size="10.00">&#45; 检测窗口在换相后延时7.5度开始</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-2035.85" font-family="Arial" font-size="10.00">&#45; 检测到零交叉后延时(15度&#45;提前角)换相</text>
<text xml:space="preserve" text-anchor="middle" x="127.28" y="-2020.85" font-family="Arial" font-size="10.00">&#45; 提前角可调整以优化效率和转矩</text>
</g>
<!-- zc_comm_relation&#45;&gt;explanation -->
</g>
</svg>
